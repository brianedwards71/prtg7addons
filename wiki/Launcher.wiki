#summary PTF launcher: Have your PRTG Server launch external applications.
#sidebar KrijcoWikiSidebar

= Introduction =

PTF launcher is a Custom Notification that can launch external applications.

PRTG Server runs as a service and therefore cannot start applications that interact with the desktop.
With PTF Launcher, this is no longer an issue.


= Prerequisites =
PTF Launcher targets the .Net Framework 2.0 that comes with Windows update and is already included in the default installation of Windows 7.

= Installation =
The download includes two .exe files:
 * Launch.exe is the Custom Notification and needs to be copied to the *\Notifications\EXE* subfolder of your PRTG installation. 
 * Launcher.exe is a system tray application that needs to be started on your PRTG server or any other Windows computer that has a user loggedin.
The Launch.exe Custom Notification parses the details of the external application that needs to be started to the Launcher.exe tray application that actually starts the external application.

= Start the Launcher application =
Once the Launcher application is started, it will be visible in your system tray (next to the clock).

http://gf-ptf.googlecode.com/files/Launcher.png

_For the launcher application to work, a user must always be logged into the computer running the launcher application._

PTF Launcher is “session aware”, if two or more RDP sessions on the same server both run PTF Launcher, only one session will start the external application. 

*Tip:* Copy Launcher.exe to the startup folder of the computer it is running on to have it automatically started when the computer is restarting.

= Custom Notification =

In the parameter section of the Custom Notification you have to provide details about the application that has to be started.

Basic parameters:

{{{
-s=	Application to start
-a=	Arguments for the application to start
-k=	Application to kill
}}}

Advanced Parameters

{{{
-c=	If Launcher.exe runs on a computer different from your PRTG Server, the IP-Address or DNS name of the computer where Launcher.exe runs.
-u=	Domain\username of an account with access rights to the c$ of the specified computer.
-p=	Password or passhash* of an account with access rights to the c$ of the specified computer.
-io=    Activate a comport on the target machine.
}}}

A passhash can be generated with the PassHash Tool.

For example:
{{{
-s=cmd -a=/K ipconfig /ALL
}}}
Will open a new command window with ipconfig

{{{
-k=cmd -s=cmd -a=/K ping %host
}}}
Will kill the existing command window and ping the sensors host in an a new command window

Activating a comport on the target machine:
{{{
-io=4,7,1 will activate the relay connected to pin 7 on comport 4.
-io=4,7,0 will deactivate the relay connected to pin 7 on comport 4.
-io=4,7,1,5 will activate the relay connected to pin 7 on comport 4 for 5 seconds.
}}}

The illustration below shows you how to wire the comport on the target machine:

http://gf-ptf.googlecode.com/files/DB9Pinout2.jpg

Please see the documentation that is included in the [Notifications download] for more details.